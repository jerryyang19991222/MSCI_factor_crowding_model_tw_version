# 🧠 MSCI 因子擁擠模型 台灣版本研究報告

本研究乃參考MSCI於2018年7月所發布之因子擁擠模型對於因子於時間序列上擁擠度之度量方法。根據原始論文衡量因子擁擠度之指標可以分為兩大類（持有基礎、評價及報酬基礎）。持有基礎之優點為其衡量之方式較能直接衡量目標因子之擁擠程度，然而其資料更新頻率較慢，例如：放空未平倉量。評價及報酬基礎之優點為其資料更新頻率較慢，然而其僅能間接衡量目標因子之擁擠程度，例如：成對相關係數、因子波動度、因子長期反轉及估值價差。

|       | 優點       | 缺點   | 衡量基礎   |
|--------------|------------|------------|------------|
| 持有基礎 | 直接衡量擁擠度   | 資料更新較慢   |放空未平倉量   |
| 評價及報酬基礎 | 資料更新較即時   | 間接衡量擁擠度 |成對相關係、因子波動度、因子長期反轉、估值價差 |

根據MSCI因子擁擠模型所定義，其最終之五種指標乃為放空未平倉量、成對相關係數、因子波動度、因子長期反轉與估值價差先於時間序列上以滾動視窗到第一筆資料進行標準化。其中成對相關係數、放空未平倉量、因子長期反轉這三類指標於標準化時所用之標準差乃為所有受試因子擁擠度標準差之平均值。

| 指標名稱       | 標準化方式                  | 標準化參數         | 綜合擷取指標     |
|----------------|-----------------------------|--------------------|------------------|
| 估值價差       | rolling expending windows    | own mean<br>own std |                  |
| 成對相關係數   | rolling expending windows    | own mean<br>global std |              |
| 放空未平倉量   | rolling expending windows    | own mean<br>global std | 等權重平均合成 |
| 因子波動度     | rolling expending windows    | own mean<br>own std |                  |
| 因子長期反轉   | rolling expending windows    | own mean<br>global std |              |


用於該次研究之因子如下表，我們將Cmoney日個股屬性評分表中之因子根據主觀分類為10大類因子並且作橫截面上標準化與等權重合成為10個綜合因子作為本研究之標的因子。

>>>>>插入表格<<<<<<

本次驗證因子擁擠模型是否有效乃參考原始研究報告(如下表)，惟本研究於相關性檢定中另外新增因子擁擠指標與未來n日夏普比率之相關係數，用以衡量因子產生報酬之效率。

>>>>>插入表格<<<<<<

## 1. 估值價差（Valuation Spread）
估值價差（Valuation Spread）係用以衡量某一因子高分組與低分組股票之間的估值差異，旨在反映市場資金是否集中於高估或低估標的，進而捕捉可能由過度交易所導致的價格偏離現象。本研究依據因子值將股票由高至低排序，擷取前 20%（Top Quintile）與後 20%（Bottom Quintile）作為比較對象，並使用三項估值指標進行量化：股價淨值比（Book-to-Price, B/P）、銷售比（Sales-to-Price, S/P）與預測盈餘殖利率（Earnings-to-Price, E/P）。在計算上，B/P 與 S/P 採用對數比方式，公式分別為 B/P Spread = ln(Median(B/P)_Bottom ÷ Median(B/P)_Top) 與 S/P Spread = ln(Median(S/P)_Bottom ÷ Median(S/P)_Top)，以避免整體市場水位變動對結果造成過度干擾；E/P 指標則因可能出現零或負值，改以差值表示，即 E/P Spread = Median(E/P)_Bottom − Median(E/P)_Top。上述三項估值指標再取等權平均，構成綜合估值價差指標，並進一步以時間序列進行 Z 分數標準化處理，以利於後續與其他擁擠指標進行整合比較。

>>>>>插入圖片<<<<<<

由上圖我們可以發現綜合估值價差指標與因子未來收益率除了三大法人因子、品質因子與成長因子皆有相當程度的負相關，而與因子未來收益率波動度之相關性則沒有太明顯的趨勢。顯示估值價差對因子未來收益具有良好的負向預測能力，然而對於未來波動則沒有良好的正向預測能力。

## 2. 成對相關係數（Pairwise Correlation）
成對相關係數（Pairwise Correlation）係用以量測因子分組內股票報酬之間的平均相關性，反映市場資金是否出現集中進出同一因子成分股之同步行為，並進一步識別可能因擁擠造成的報酬共振現象。具體計算方式為：首先擷取近 63 個交易日的日報酬資料，並將股票依據因子值排序後選取前 20%（Top Quintile）與後 20%（Bottom Quintile）兩組，針對 Top Quintile 中每一檔個股，計算其報酬與同組其他股票（不含自身）平均報酬之間的皮爾森相關係數，並對所有個股取平均，記為 ρ_top；Bottom Quintile 同樣依此方式計算並記為 ρ_bottom。最終，將兩組平均相關係數加總取半，得到整體指標值：Pairwise Correlation = ½ (ρ_top + ρ_bottom)。該指標最終亦會進行時間序列 Z-score 標準化，以利與其他擁擠度指標合併分析。

>>>>>插入圖片<<<<<<

由上圖我們可以發現成對相關係數指標與因子未來收益率除了價值因子外皆有相當程度的正相關，而與因子未來收益率波動度之相關性則有相當程度之正相關。顯示成對相關係數對因子未來收益不具有良好的負向預測能力，然而對於未來波動則具有良好的正向預測能力。

## 3. 放空未平倉量差（Short Interest Spread）
放空未平倉量差（Short Interest Spread）係用以反映某一因子高分組與低分組股票在放空利用率（short utilization）上的差異，藉此量測市場中是否存在對沖基金等機構大量放空該因子低分組股票的情形。首先，取得各股票的放空利用率，計算方式為「放空股數除以可放空總股數」。接著，進行多因子橫斷面回歸，模型將放空利用率作為被解釋變數，自變數則為因子本身與控制變數（如 size、value、momentum）之分位數虛擬變數（I_q），具體式為：SI_i = ∑₍q=1₎⁵ k_{q,factor}·I_{iq} + ∑₍q=1₎⁵ k_{q,size}·I_{iq} + ⋯。其中 I_{iq} 為第 q 分位的指標變數。完成回歸後，擷取該因子第 1 分組（低分組）與第 5 分組（高分組）之回歸係數，計算其差值作為指標值，即 Short Interest Spread = k_{1,factor} − k_{5,factor}，用以量化放空壓力的傾斜程度。最終，該指標將以時間序列方式進行標準化處理，採用歷史擴展平均與全體因子的共同標準差，以提高跨因子比較的一致性與穩定性。

>>>>>插入圖片<<<<<<

由上圖我們可以發現放空未平倉量指標與因子未來收益率除了品質因子、動能因子、價值因子外皆有相當程度的負相關，而與因子未來收益率波動度之相關性則有相當程度之負相關。顯示放空未平倉量差對因子未來收益具有良好的負向預測能力，然而對於未來波動則不具有良好的正向預測能力。

## 4. 因子波動度（Factor Volatility）
因子波動度（Factor Volatility）係用以衡量某一因子預測報酬的波動程度相對於市場整體波動度的比值，旨在觀察該因子是否正處於異常高波動、資金敏感或潛在轉折的風險區間。計算方式上，首先以 63 個交易日為滾動視窗，計算該因子的日收益標準差，作為其近期波動性的估計值，並與同期市場報酬標準差相比，取得相對波動度指標。此一比值若偏高，代表該因子近期報酬震盪劇烈，可能與市場情緒或擁擠程度有關。為利於跨時期與跨因子比較，最終將該指標值進行時間序列 Z-score 標準化，並納入綜合擁擠分數模型作為解釋變數之一。

>>>>>插入圖片<<<<<<

由上圖我們可以發現因子波動度指標與因子未來收益率具有相當程度的正相關，而與因子未來收益率波動度之相關性則有相當程度之正相關。顯示因子波動度對因子未來收益不具有良好的負向預測能力，然而對於未來波動則具有良好的正向預測能力。

## 5. 因子長期反轉（Factor Reversal）
因子長期反轉指標（Factor Reversal）係用以量化某一因子過去三年（約 36 個月）的累積報酬表現，目的在於識別因子是否出現長期績效過熱的情形，進而揭示潛在反轉風險。此指標反映投資人常見的「追高殺低」行為對因子資金流向的影響，當一因子長期表現強勢，可能吸引過度資金進場，導致擁擠，並提高未來報酬反轉的可能性。計算上，直接將該因子近 36 個月的報酬加總，形成 Reversal Metric = ∑{t=−36}^{0} r{t,factor}，作為長期績效累積量度。最終，該指標將以各因子自身的歷史均值與全體因子共同標準差進行 Z-score 標準化，以確保時序穩定性與跨因子比較性，並納入綜合擁擠分數模型作為反轉風險評估構面。

>>>>>插入圖片<<<<<<

由上圖我們可以發現因子長期反轉指標與因子未來收益率除了流動性因子、融資券因子、三大法人因子、公司治理因子外皆有相當程度的負相關，而與因子未來收益率波動度之相關性除了動能因子與價值因子外具有相當程度之正相關。顯示因子長期反轉對因子未來收益具有良好的負向預測能力，同時對於未來波動則具有良好的正向預測能力。

## 6. 綜合擁擠分數(Integrated Crowding Score）
綜合擁擠分數是將五個擁擠指標（估值價差、成對相關、放空壓力、因子波動度、因子長期反轉）標準化後加總，形成單一指標，以整體量化某因子的擁擠程度。

>>>>>插入圖片<<<<<<

由上圖我們可以發現綜合擁擠分數與因子未來收益率不具有明顯的趨勢，而與因子未來收益率波動度之相關性具有明顯正向相關。顯示綜合擁擠分數對因子未來收益不具有良好的負向預測能力，然而對於未來波動則具有良好的正向預測能力。

>>>>>插入圖片<<<<<<

我們進一步利用綜合擁擠分數將因子分群，由上圖我們可以發現在綜合擁擠分數小於1的情況下因子收益率於為來一年發生超過5%回撤的機率是隨綜合擁擠分數上升而上升的。

我們進一步利用綜合擁擠分數將因子分類為非擁擠、中性及擁擠，如下表所示：

>>>>>插入表格<<<<<<

>>>>>插入圖片<<<<<<

由上圖我們可以發現，非擁擠因子雖然於12個月之月平均報酬率小於中性及擁擠因子，而在12至24個月之月報酬率則逐步上漲。可能為因子於擁擠時仍可能有一年的上漲動能所致。

>>>>>插入圖片<<<<<<

由上圖我們可以發現，非擁擠因子在24個月中之月平均報酬波動度皆小於擁擠及中性因子，顯示該擁擠模型隨然對於因子未來收益率不具明顯之預測能力，而對於未來波動度確實有明顯之正向預測能力，與前面之相關性檢定結果相符。







---

# 📊 使用方式

請先準備好一個含有 MultiIndex（時間、股票代碼）且 column 為因子名稱的 Panel Data。

```python
# 執行 crowding 模型主程式
python get_crowding_model.py

input_path = 你的檔案路徑
output_path = /
factor_return_type = quantile_ls  # 或 ic
